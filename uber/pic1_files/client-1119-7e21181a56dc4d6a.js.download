(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[1119],{13864:(t,e,i)=>{"use strict";i.d(e,{S:()=>F,C:()=>W});var o=i(43193),n=i(67378),r=i(55831),s=i(72718),a=i.n(s),l=i(20598),p=i(34710),c=i(36151),u=i(15537),d=i(33990);class h extends c.Component{render(){return(0,d.tZ)(u.Z,{viewBox:"0 0 24 24",...this.props,children:(0,d.tZ)("path",{d:"M10.5 13.5L.5 11 21 3l-8 20.5-2.5-10z"})})}}var f=i(24071);class g extends o.PureComponent{render(){return(0,d.tZ)(f.Q,{$color:this.props.color})}}const m=g;function v(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const{colors:b}=n.v,x=(0,r.zo)("div",(t=>{let{$rtl:e}=t;return{position:"absolute",height:"100%",[e?"left":"right"]:"15px",cursor:"pointer",fontSize:"16px",width:"1em",display:"flex",alignItems:"center",justifyContent:"center"}})),y=t=>{let{$error:e,$isLoadingCurrentLocation:i}=t;return{color:e?b.negative400:b.black,opacity:e||i?1:.2,":hover":{color:b.primary600,opacity:1},":focus":{color:e?b.negative400:b.primary600,opacity:1}}},k=(0,r.zo)(p.Z,y),I=(0,r.zo)(h,y);class D extends o.PureComponent{constructor(){super(...arguments),v(this,"clearSelection",(()=>{this.props.clearSelection(this.props.type)})),v(this,"handleLocationKeyPress",(t=>{t&&"Enter"===t.key&&this.props.fetchCurrentLocation()})),v(this,"handleDeleteKeyPress",(t=>{t&&"Enter"===t.key&&this.clearSelection()}))}render(){const{rtl:t,isVisible:e,fetchCurrentLocation:i,localization:o,isLoadingCurrentLocation:n,error:r}=this.props;return n?(0,d.tZ)(x,{$rtl:t,$error:r,$isLoadingCurrentLocation:n,children:(0,d.tZ)(m,{color:b.primary300})}):(0,d.tZ)(x,{$rtl:t,children:e?(0,d.tZ)(k,{width:"12px",height:"12px",onClick:this.clearSelection,onKeyPress:this.handleDeleteKeyPress,tabIndex:"0",role:"button",size:"small","aria-label":o.clearPickupAriaLabel,$error:r,$isLoadingCurrentLocation:n,className:"pe-location-clear"}):(0,d.tZ)(I,{width:"16px",height:"16px",onClick:i,onKeyPress:this.handleLocationKeyPress,tabIndex:"0",role:"button",size:"small","aria-label":o.locationLabel,$error:r,$isLoadingCurrentLocation:n,className:"pe-location-fetch"})})}}var L=i(552),P=i.n(L);function S(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const{colors:C}=n.v,w=(0,r.zo)("ul",{border:0,left:0,right:0,listStyle:"none",margin:0,padding:"16px 0",overflowY:"auto",position:"absolute",zIndex:2,backgroundColor:C.primary50}),$=(0,r.zo)("div",{backgroundColor:C.black,opacity:.1,position:"absolute",top:0,left:"18px",right:"18px",height:"1px"}),z=(0,r.zo)("li",(t=>{let{$focused:e,$isLast:i}=t;return{color:C.primary,backgroundColor:e?C.primary200:C.primary50,display:"flex",alignItems:"center",cursor:"pointer",minHeight:"45px",padding:"0 43px",boxSizing:"border-box",fontSize:"16px",lineHeight:"26px"}})),Z=(0,r.zo)("span",{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"});class E extends o.PureComponent{constructor(){super(...arguments),S(this,"handleKeysPressed",(t=>{const{items:e,closeList:i,type:o,focusedIndex:n}=this.props;if(e){let r;if("ArrowDown"===t.key&&(r=null===n||n>=e.length-1?0:n+1,t.preventDefault&&t.preventDefault(),this.props.focusIndex(r)),"ArrowUp"===t.key&&(r=null===n||n<=0?e.length-1:n-1,t.preventDefault&&t.preventDefault(),this.props.focusIndex(r)),"Enter"===t.key){const{id:i,provider:o}=e[n];return t.preventDefault&&t.preventDefault(),this.props.onClickItem(i,o,n)}if("Escape"===t.key&&o)return t.preventDefault&&t.preventDefault(),i(o)}})),S(this,"findFirstStringIndices",((t,e)=>{const i=e.toLowerCase(),o=(t||"").trim().toLowerCase(),n=[];if(o){let t=!0;for(;t;){const e=n.length?n[n.length-1]-1:void 0,r=i.lastIndexOf(o,e);-1!==r&&n.push(r),-1!==r&&r||(t=!1)}}return n})),S(this,"getSuggestionItem",(t=>{const e=(this.props.inputValue||"").trim();if(e){const i=this.findFirstStringIndices(e,t);if(i.length){let o=t;return i.forEach((t=>{o=o.slice(0,t)+"<strong>".concat(o.slice(t,t+e.length),"</strong>")+o.slice(t+e.length,o.length)})),o}}return t}))}componentDidMount(){P()&&P().addEventListener("keydown",this.handleKeysPressed)}componentWillUnmount(){P()&&P().removeEventListener("keydown",this.handleKeysPressed)}render(){const{type:t,items:e,listBoxId:i,focusedIndex:o}=this.props;return t&&(0,d.BX)(w,{id:i,className:"pe-suggestions",role:"listbox",children:[(0,d.tZ)($,{}),e&&e.map(((i,n)=>{const{addressLine1:r,addressLine2:s,id:a,provider:l}=i,p="".concat(r).concat(s?", ".concat(s):"");return(0,d.tZ)(z,{$focused:o===n,$isLast:n===e.length-1,onClick:t=>this.props.onClickItem(a,l,n),className:"pe-suggestions-item",role:"option","aria-selected":o===n,"aria-label":p,id:a,children:(0,d.tZ)(Z,{dangerouslySetInnerHTML:{__html:this.getSuggestionItem(p)}})},"".concat(t,"-suggestion-").concat(n))}))]})}}function B(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const{colors:O}=n.v,{values:{fontFamily:j,mediaQueries:T}}=l.ZP,F=1,M={content:'""',position:"absolute",left:"-3px",width:"6px",height:"6px"},R=(0,r.zo)("div",(t=>{let{$rtl:e,$hidden:i,$pickup:o,$destination:n}=t;return{position:"absolute",top:"33px",bottom:"33px",[e?"right":"left"]:"22px",width:"1px",backgroundColor:i?"none":O.black,":before":{...M,bottom:"-10px",border:"1px solid ".concat(O.black),backgroundColor:n?O.black:O.primary50,width:"5px",height:"5px"},":after":{...M,top:"-10px",borderRadius:"50%",border:"1px solid ".concat(O.black),backgroundColor:o?O.black:O.primary50}}})),K=(0,r.zo)("div",(t=>{let{$removeTopMargin:e}=t;return{flex:"0 0 auto",fontFamily:j.body,marginBottom:"13px",marginTop:e?0:"31px",position:"relative",[T.palm]:{marginBottom:"26px",marginTop:e?0:"20px"}}})),V=(0,r.zo)("div",(t=>{let{$gutter:e}=t;return{position:"relative",display:"flex",flexDirection:"row",width:"100%",marginTop:e?0:"8px"}})),N=(0,r.zo)("div",{position:"relative",display:"flex",flexDirection:"row",flex:"1 1 auto"}),A=(0,r.zo)("input",(t=>{let{$theme:e,$error:i,$rtl:o}=t;const{typography:n}=e;return{position:"relative",zIndex:0,flex:1,minHeight:"52px",backgroundColor:O.primary50,[o?"paddingLeft":"paddingRight"]:"33px",[o?"paddingRight":"paddingLeft"]:"41px",paddingTop:"11px",paddingBottom:"11px",border:"none",color:i?O.negative400:O.black,outline:"none",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",lineHeight:"24px",boxSizing:"border-box",margin:0,width:"100%",...n.font300}})),H=(0,r.zo)("div",(t=>{let{$rtl:e}=t;return{position:"absolute",height:"100%",width:"16px",[e?"left":"right"]:"15px",cursor:"pointer",fontSize:"23px",display:"flex",alignItems:"center",justifyContent:"center"}})),U=(0,r.zo)(p.Z,{color:O.black,opacity:.2,":hover":{color:O.primary600,opacity:1},":focus":{color:O.primary600,opacity:1}});class W extends o.PureComponent{constructor(t){super(t),B(this,"state",{isDetectionError:!1,pickupInput:"",destinationInput:"",focusedInput:null,prevPickupDetails:null,prevDestinationDetails:null,focusedPickupIndex:0,focusedDestinationIndex:0}),B(this,"destinationListBoxId","destination-suggestions-listbox-".concat(Math.random())),B(this,"pickupListBoxId","pickup-suggestions-listbox-".concat(Math.random())),B(this,"mapToSubmitEstimatePoint",((t,e)=>({id:t.id,provider:t.provider,locale:e,latitude:t.lat,longitude:t.long}))),B(this,"setInputValue",((t,e)=>{this.setState({["".concat(t,"Input")]:this.getInputValueFromPoint(e)})})),B(this,"getInputValueFromPoint",(t=>t.addressLine1&&t.addressLine2?"".concat(t.addressLine1,", ").concat(t.addressLine2):"".concat(t.fullAddress))),B(this,"fetchSuggestions",(t=>{const{locale:e}=this.props,{lat:i,long:o}=this.getTargetLatLng();this.props.getSuggestions({type:t.name,q:t.value,locale:e,lat:i,long:o})})),B(this,"getTargetLatLng",(()=>{const{mapCenter:t,pickupDetails:e,destinationDetails:i}=this.props;return e&&e.lat?{lat:e.lat,long:e.long}:i&&i.lat?{lat:i.lat,long:i.long}:{lat:t.latitude,long:t.longitude}})),B(this,"clickSuggestionItem",((t,e,i)=>{const o=this.state.focusedInput,{locale:n,suggestions:r}=this.props;o&&r&&r[o]&&(this.props.loadPlaceDetails({type:o,locale:n,id:r[o][i].id,provider:r[o][i].provider}),this.loadNextChangedPlace("pickup"===this.state.focusedInput?"destination":"pickup"))})),B(this,"focusIndex",(t=>{const e=this.state.focusedInput;if(e){const i="pickup"===e?"focusedPickupIndex":"focusedDestinationIndex";this.setState({[i]:t})}})),B(this,"loadNextChangedPlace",(t=>{this.props.suggestions[t]&&this.props.suggestions[t].length&&(!this.props["".concat(t,"Details")]&&this.state["".concat(t,"Input")]||this.props["".concat(t,"Details")]&&this.state["".concat(t,"Input")]!==this.getInputValueFromPoint(this.props["".concat(t,"Details")]))&&this.props.loadPlaceDetails({type:t,locale:this.props.locale,id:this.props.suggestions[t][0].id,provider:this.props.suggestions[t][0].provider}),this.setState({focusedInput:null})})),B(this,"focusPickup",(()=>{this.pickupRef.focus()})),B(this,"focusDestination",(()=>{this.destinationRef.focus()})),B(this,"clearInput",(t=>{this.setState({["".concat(t,"Input")]:"",focusedInput:null,["".concat(t,"InputChanged")]:!1}),this.fetchSuggestions({name:t,value:""}),this.props["".concat(t,"Details")]&&(this.props.clearFEPlaceDetails(t),this.props.clearFEDirections())})),B(this,"closeSuggestionsList",(t=>{this.setState({focusedInput:null}),this["".concat(t,"Ref")].blur()})),B(this,"triggerDetactionError",((t,e)=>{this.setState({isDetectionError:t&&e===F},(()=>{this.props.setDetectionError(t,e)}))})),B(this,"fetchCurrentLocation",(()=>{this.triggerDetactionError(!1),window&&navigator.geolocation.getCurrentPosition((t=>{t&&t.coords?(this.props.fetchCurrentLocation({lat:t.coords.latitude,lng:t.coords.longitude,lang:this.props.locale}),this.loadNextChangedPlace("destination")):this.triggerDetactionError(!0)}),(t=>{this.triggerDetactionError(!0,t.code)}))})),B(this,"onInputChanged",(t=>{let{target:e}=t;this.setState({["".concat(e.name,"Input")]:e.value,focusedInput:e.name,["".concat(e.name,"InputChanged")]:!0},(()=>{this.triggerDetactionError(!1),this.fetchSuggestions(e)}))})),B(this,"onInputFocused",(t=>{let{target:e}=t;return this.setState({focusedInput:e.name})})),B(this,"onInputBlured",(t=>{let{target:e}=t;setTimeout((()=>{e.name===this.state.focusedInput&&this.setState({focusedInput:null})}),150),this.props.dataTrackingHandler&&this.props.dataTrackingHandler(e.value,e.name)})),B(this,"clearDestinationSelection",(()=>this.clearInput("destination"))),B(this,"saveDestRef",(t=>this.destinationRef=t)),B(this,"savePickupRef",(t=>this.pickupRef=t)),B(this,"handleDeleteDestinationKeyPress",(t=>{t&&"Enter"===t.key&&this.clearDestinationSelection()})),this.fetchSuggestions=a()(this.fetchSuggestions,300)}static getDerivedStateFromProps(t,e){const{isPickupUsingCurrentLocation:i,destinationDetails:o,pickupDetails:n}=t,{prevDestinationDetails:r,prevPickupDetails:s,destinationInput:a}=e,l=!s||n!==s,p=n&&l&&{prevPickupDetails:n,pickupInput:n.addressLine1};if(i&&p){const t=o&&!a?{destinationInput:o.fullAddress}:{};return{...p,...t}}const c=o&&(!r||o!==r)&&{prevDestinationDetails:o,destinationInput:o.fullAddress},u=n&&l&&{prevPickupDetails:n,pickupInput:n.fullAddress};return c||u?{...c||{},...u||{}}:e}componentDidUpdate(t){let e=!1;this.props.pickupDetails&&t.pickupDetails!==this.props.pickupDetails&&(this.setInputValue("pickup",this.props.pickupDetails),e=!0),this.props.destinationDetails&&t.destinationDetails!==this.props.destinationDetails&&(this.setInputValue("destination",this.props.destinationDetails),e=!0),!e||this.props.placeDetailsLoading.pickup||this.props.placeDetailsLoading.destination||(this.props.destinationDetails&&this.props.pickupDetails&&(this.props.loadFEDirections&&this.props.loadFEDirections({destinationDetails:this.props.destinationDetails,pickupDetails:this.props.pickupDetails}),this.props.loadFareEstimates&&this.props.loadFareEstimates({origin:this.mapToSubmitEstimatePoint(this.props.pickupDetails,this.props.locale),destination:this.mapToSubmitEstimatePoint(this.props.destinationDetails,this.props.locale),locale:this.props.locale})),this.props.pickupDetails&&!this.props.destinationDetails?this.focusDestination():!this.props.pickupDetails&&this.props.destinationDetails&&this.focusPickup())}render(){var t,e;const{localization:i,suggestions:o,errors:n,isLoadingCurrentLocation:r,rtl:s,pickupDetails:a,destinationDetails:l,removeTopMargin:p}=this.props,{pickupInput:c,destinationInput:u,focusedInput:h,isDetectionError:f,focusedPickupIndex:g,focusedDestinationIndex:m}=this.state,v=h&&o&&o[h],b=!(null==v||!v.length)&&"pickup"===h,x=!(null==v||!v.length)&&"destination"===h,y=b&&(null==v||null===(t=v[g])||void 0===t?void 0:t.id),k=x&&(null==v||null===(e=v[m])||void 0===e?void 0:e.id);return(0,d.BX)(K,{$removeTopMargin:p,children:[(0,d.BX)(V,{$gutter:!0,role:"combobox","aria-expanded":b,"aria-owns":this.pickupListBoxId,"aria-haspopup":"listbox",children:[(0,d.tZ)(A,{name:"pickup",$error:n&&n.pickup||f,ref:this.savePickupRef,value:c,title:c,"aria-label":this.props.localization.pickupAriaLabel,placeholder:this.props.localization.pickupPlaceholder,onChange:this.onInputChanged,onFocus:this.onInputFocused,onBlur:this.onInputBlured,autoComplete:"off",$rtl:s,type:"text","aria-autocomplete":"list","aria-controls":this.pickupListBoxId,"aria-activedescendant":y}),(0,d.tZ)(D,{rtl:s,type:"pickup",isLoadingCurrentLocation:r,isVisible:!(null==c||!c.length),clearSelection:this.clearInput,fetchCurrentLocation:this.fetchCurrentLocation,localization:i,error:f})]}),b&&(0,d.tZ)(E,{inputValue:c,type:h,items:v,onClickItem:this.clickSuggestionItem,closeList:this.closeSuggestionsList,listBoxId:this.pickupListBoxId,focusIndex:this.focusIndex,focusedIndex:g}),(0,d.tZ)(V,{$gutter:!1,role:"combobox","aria-expanded":x,"aria-owns":this.destinationListBoxId,"aria-haspopup":"listbox",children:(0,d.BX)(N,{children:[(0,d.tZ)(A,{name:"destination",$error:n&&n.destination,ref:this.saveDestRef,value:u,title:u,"aria-label":this.props.localization.destinationAriaLabel,placeholder:this.props.localization.destinationPlaceholder,onChange:this.onInputChanged,onFocus:this.onInputFocused,onBlur:this.onInputBlured,autoComplete:"off",$rtl:s,type:"text","aria-autocomplete":"list","aria-controls":this.destinationListBoxId,"aria-activedescendant":k}),!(!u||!u.length)&&(0,d.tZ)(H,{$rtl:s,children:(0,d.tZ)(U,{width:"12px",height:"12px",onClick:this.clearDestinationSelection,onKeyPress:this.handleDeleteDestinationKeyPress,tabIndex:"0",role:"button",size:"small","aria-label":this.props.localization.clearDestinationAriaLabel,className:"pe-location-clear"})})]})}),x&&(0,d.tZ)(E,{inputValue:u,type:h,items:v,onClickItem:this.clickSuggestionItem,closeList:this.closeSuggestionsList,listBoxId:this.destinationListBoxId,focusIndex:this.focusIndex,focusedIndex:m}),(0,d.tZ)(R,{$rtl:s,$hidden:"pickup"===h&&o&&o[h]&&!!o[h].length,$pickup:!!a,$destination:!!l})]})}}B(W,"defaultProps",{placeDetailsLoading:{},removeTopMargin:!1})},34710:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var o=i(36151),n=i(15537),r=i(33990);class s extends o.Component{render(){return(0,r.tZ)(n.Z,{viewBox:"0 0 12 12",...this.props,children:(0,r.tZ)("path",{d:"M10.595 0L6 4.596 1.405 0 0 1.404 4.596 6 0 10.595 1.405 12 6 7.404 10.595 12 12 10.595 7.404 6 12 1.404z"})})}}},15537:(t,e,i)=>{"use strict";i.d(e,{Z:()=>r});var o=i(43193),n=i(33990);class r extends o.Component{render(){const{children:t,...e}=this.props;return t&&(0,n.tZ)("svg",{"aria-hidden":"true",focusable:"false",width:"1em",height:"1em",fill:"currentColor",...e,children:t})}}},70960:(t,e,i)=>{"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.Z=void 0;var n=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var i=s(e);if(i&&i.has(t))return i.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var l=r?Object.getOwnPropertyDescriptor(t,a):null;l&&(l.get||l.set)?Object.defineProperty(n,a,l):n[a]=t[a]}n.default=t,i&&i.set(t,n);return n}(i(43193)),r=["title","titleId","size"];function s(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,i=new WeakMap;return(s=function(t){return t?i:e})(t)}function a(){return(a=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t}).apply(this,arguments)}function l(t,e){if(null==t)return{};var i,o,n=function(t,e){if(null==t)return{};var i,o,n={},r=Object.keys(t);for(o=0;o<r.length;o++)i=r[o],e.indexOf(i)>=0||(n[i]=t[i]);return n}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(o=0;o<r.length;o++)i=r[o],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}var p=n.forwardRef((function(t,e){var i=t.title,o=void 0===i?"Clock":i,s=t.titleId,p=t.size,c=void 0===p?"1em":p,u=l(t,r);return n.createElement("svg",a({width:c,height:c,viewBox:"0 0 24 24",fill:"none",ref:e,"aria-labelledby":s},u),void 0===o?n.createElement("title",{id:s},"Clock"):o?n.createElement("title",{id:s},o):null,n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1 12C1 5.9 5.9 1 12 1s11 4.9 11 11-4.9 11-11 11S1 18.1 1 12Zm3 0c0 4.4 3.6 8 8 8s8-3.6 8-8-3.6-8-8-8-8 3.6-8 8Zm6.5 2.5V7h3v4.5H17v3h-6.5Z",fill:"currentColor"}))}));e.Z=p},72718:t=>{t.exports=function(t,e,i){var o=null,n=null,r=function(){o&&(clearTimeout(o),n=null,o=null)},s=function(){if(!e)return t.apply(this,arguments);var s=this,a=arguments,l=i&&!o;return r(),n=function(){t.apply(s,a)},o=setTimeout((function(){if(o=null,!l){var t=n;return n=null,t()}}),e),l?n():void 0};return s.cancel=r,s.flush=function(){var t=n;r(),t&&t()},s}}}]);